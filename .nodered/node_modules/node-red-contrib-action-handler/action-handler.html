<!-- @@@LICENSE

Copyright (c) 2019 LG Electronics, Inc.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.

SPDX-License-Identifier: Apache-2.0

LICENSE@@@ -->

<style>
    .form-row textarea {
        width: 75%;
        height: 100px;
        border-radius: 3px;
        resize: none;
        padding: 10px;
    }
</style>

<script type="text/x-red" data-template-name="action-handler">
    <div class="form-row">
        <label for="node-input-name">
            <i class="icon-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
    <div class="form-row">
        <label for="node-input-nodetype">
            <i class="icon-tag"></i> Type</label>

        <select onchange="changeActionManager1(this)">
            <option value="Launch" selected>Launch</option>
            <option value="Control" disabled>Control</option>
        </select>
    </div>

    <div class="form-row" id="node-input-appidNew">
        <label for="node-input-appId">
            <i class="icon-tag"></i> AppId</label>
        <input type="text" id="node-input-appId" placeholder="Enter AppId to launch">
    </div>

    <div class="form-row" id="node-input-nodevalueNew">
        <label for="node-input-params">
            <i class="icon-tag"></i> Params</label>
        <textarea id="node-input-params" class="textDisplay" placeholder="{ 'param1': 'value'}"></textarea>
    </div>

</script>


<script type="text/x-red" data-help-name="action-handler">
    <h2><strong>Action-Handler</strong></h2>
    <p>Action-Handler node response to launch/control the application</p>
    <p> <b>Name:</b> Display the name of the given node</p>
    <p><b>Type:</b> It is a drop-down selection with the following options<br>
        <dl class="message-properties">
                <dt>Launch:</dt>
                <dd> If launch option is selected, it will launch the application with the property- Appid(required) and Params(optional)</dd>
                <dt>Control:</dt>
                <dd><i>Currently Control option is disabled</i></dd>
        </dl>

    </p>
    <p><b>AppId:</b> Application Id to be launched the application. <i>This option is enabled only if 'Type' is launched</i> <br>
        1. If the appId comes from the previous node will be undertaken(Priority based on previous node) than the user entered manually.<br>
        2. If the appId is not available or empty, then the user entered manually will be undertaken
        </p>
        <p> Sample AppId: "com.lg.app.face"</p>
    <p><b>Params(optional):</b> The Launch Parameter for an application to be launch.<i>This option is enabled only if 'Type' is launched</i> </br>
        1. If the launch Params comes from the previous node then the launch-params of user entered manually in the node-properties of action handler should be merged with that from the previous node<br>
        2. If the launch Params is not available from the previous node then the launch-params of action handler where user can entered manually will be undertaken
        </p>
        <pre>Sample Params:{
                "handpose":"",
                "handPosition":"",
                "handEvent":"",
                "handNum": ""
            }
        </pre>

</script>

<script type="text/javascript">
    RED.nodes.registerType('action-handler', {
        category: 'LG',
        color: '#87a980',
        defaults: {
            name: {
                value: ""
            },
            appId: {
                value: ""
            },
            nodetype: {
                value: "launch",
                required: true
            },
            params: {
                value: "",
                validate: function (v) {
                    if (v != "") {
                        try {
                            v = JSON.parse(v);
                            return true;
                        } catch (e) {
                            return false;
                        }
                    } else {
                        return true;
                    }
                }
            }
        },
        inputs: 1,
        outputs: 0,
        icon: "link-out.png",
        label: function () {
            return this.name || "action-handler";
        }
    });
</script>
<script type="text/javascript">
    function changeActionManager1(obj) {
        switch (obj.value) {
            case "Launch":
                $("#node-input-appidNew").show();
                $("#node-input-nodevalueNew").show();
                $("#node-input-nodesettingNew").hide();
                break;
            case "Control":
                $("#node-input-appidNew").hide();
                $("#node-input-nodevalueNew").hide();
                $("#node-input-nodesettingNew").hide();
                break;
        }
    }
</script>